使用Golang语言建造EventSourcing/CQRS的微服务
=============

在这篇文章中，我将演示`Go`中的一个简单的`EventSourcing/CQRS`示例，演示如何解决基于微服务的分布式系统的实际挑战。请记住，这篇文章的目的不是介绍EventSourcing和CQRS的最佳实践，而是通过在Go中编写一个简单的示例来介绍这两种架构和设计模式，它为构建基于微服务的分布式系统提供了解决方案，以便处理事务和数据。

### 微服务中最难的部分：数据和事务
----------

从未在分布式系统上工作的人一直误解微服务只能在`Docker`容器中运行服务并使用`Kubernetes`进行编排， 在我的国家，印度，很多人一直在提供关于微服务的企业培训和指导，有两个误解：微服务只是用`Kubernetes`编排容器，或者只是在`Netflix OSS`中使用`Spring Boot`框架。 但实际上，微服务是一种分布式系统架构模式，它完全用于构建高度可扩展和可演化的软件系统的功能分解。 简而言之，微服务是一种协同工作的小型自治服务。

#### 数据分散在微服务的多个数据库中
---------

分解微服务的一种常用做法是针对有界上下文来设计每个微服务，这是*领域驱动设计*`(DDD)`中的中心模式，通过将大的域模型划分为多个不同的逻辑域，将业务问题分解到各个子域的有界上下文中。单个有界上下文可以通过一个或多个聚合进行事务。因为我们通常针对每个有界上下文构建微服务，所以我们通常为每个微服务使用单独的数据库，每个微服务看起来像一个独立的系统。

因为我们将单体系统分解成几个自治服务，所以数据会分散在各个微服务所对应的几个数据库中。这使您的应用程序和体系结构变得非常复杂。 例如，业务事务可能跨越多个微服务。 假设您构建了一个带有微服务的电子商务系统，其中下订单最初将由一个微服务——`OrderService`处理，然后支付处理可能由另一个服务——`PaymentService`完成，依此类推。 另一个挑战是从多个数据库查询数据。 使用单体(`monolithic`)数据库，您可以轻松地从单个数据库执行连接查询。 由于单片数据库作为功能组件分解的一部分被移动到多个数据库中，因此您不能简单地执行连接查询，因此您必须从多个数据库中获取数据。 在这里，您没有任何集中式数据库。
